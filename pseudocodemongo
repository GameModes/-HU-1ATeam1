import databaseconnectiemodule, databaseadaptermodule, csvaanmaakbestandmodule

def verwijderkomma's:
    Geef alle waarden terug, waarbij de komma wordt vervangen door niks
   
connectie = inloggevens voor psycopg2 om te koppelen met de database
cursor = zet een cursor om bij te houden waar je bent

cursor.execute(verwijder alle tabellen als ze eerder zijn gemaakt met hun gegevens)
connectie.commit

cursor.execute(maak tabellen aan met hun relaties en keys)
connectie.commit

#kopje Profiles
with open profiles.csv bestand met als leesregelvervanging ("w") als naam profs:
   fieldnames = plek waar de bezochte products staan
   profwriter = maakt een Profile Dictionary writer aan voor in de csv bestand uit de plaats van de gegevens (fieldnames)
   c = meetel variabele, om bij fout meldingen te kijken waar het programma gebleven is.
   for profielen in de sectie visitors in de MongoDB database:
       buidslist = sla id's van gebruikers op in een lijst
       if ";" niet in de lijst buids zit:
            maakt van de waarde None (niet bestaand) om fouten te voorkomen
      if c een 100000 tal bereikt dan:
        print(hoeveelheid c)
print(klaar met profiles downloaden)

#kopje Sessions
with open sessions.csv bestand met als leesregelvervanging ("w") als naam sess:
   fieldnames = plek waar de
   sesswriter = maakt een Profile Dictionary writer aan voor in de csv bestand uit de plaats van de gegevens (fieldnames)
   c = meetel variabele, om bij fout meldingen te kijken waar het programma gebleven is.
   for sessions in de sectie sessions in de MongoDB database:           
        

      if c een 100000 tal bereikt dan:
        print(hoeveelheid c)
print(klaar met sessions laden)

#kopje Product
with open productencsv bestand met als leesregel vervanging ("w") als naam product, open categorisecsv bestand met als leesregel vervanging ("w") als naam categorie, open discounts.csv met als leesregel vervanging ("w")
    prods_fieldnames = opent products bij de sectie genderid
    cats_fieldnames = opent de categorien bij de sectie sub_category
    discs_fieldnames = opent de kortingen bij de sectie discounts
    brands_fieldnames = opent de merken bij de sectie brand
    vars_fieldnames = opent de variatie bij de sectie variant
    doels_fieldnames = opent de doelgroepen bij de sectie doelgroep
    gends_fieldnames = opent de geslacht bij de sectie gender
    prod_writer = maakt een Productie Dictionary writer voor in de csv bestand uit de plaats van de gegevens (prods_fieldnames)
    cats_writer = maakt een Categorie Dictionary writer voor in de csv bestand uit de plaats van de gegevens (cats_fieldnames)
    discs_writer = maakt een Discount Dictionary writer voor in de csv bestand uit de plaats van de gegevens (discs_fieldnames )
    brand_writer = maakt een Merk Dictionary writer voor in de csv bestand uit de plaats van de gegevens (brands_fieldnames)
    var_writer = maakt een Variatie Dictionary writer voor in de csv bestand uit de plaats van de gegevens (vars_fieldnames )
    doel_writer = maakt een doelgroepen Dictionary writer voor in de csv bestand uit de plaats van de gegevens (doels_fieldnames)
    gend_writer = maakt een Geslacht Dictionary writer voor in de csv bestand uit de plaats van de gegevens (gends_fieldnames)
    dict = voor elke gegevenscategorie een lege dictionary behalve products
    for producten in de mongoDB in het kopje Products:
        ~
        voor elke gegevenscategorie ~
        alle_categories = categorie + sub-categorie + sub-sub-categorie
        if alle_categories niet in categoriedictionary:
            if categoriedictionary is niet leeg:
                de plek waar alle_categories in categoriedictionary = zet alle_categories achter in de lijst
            else:
                de plek waar alle_categories in categoriedictionary = zet alle_categories in de lijst
    
    
